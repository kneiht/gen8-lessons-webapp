<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PreGS6: Chủ ngữ giả It, There</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet">
    <script>
        function adjustFontSize() {
            const screenWidth = window.innerWidth;
            const htmlElement = document.documentElement;

            if (screenWidth <= 768) { // Mobile breakpoint
                htmlElement.style.fontSize = '20px';
            } else {
                // Scale font size based on screen width, with 30px at 1680px width
                const scaleFactor = screenWidth / 1680;
                const fontSize = Math.max(20, Math.min(30, 30 * scaleFactor));
                htmlElement.style.fontSize = `${fontSize}px`;
            }
        }

        function showZoomInstructions() {
            // Check if it's a mobile device
            if (window.innerWidth <= 768) {
                return;
            }

            if (localStorage.getItem('hideZoomInstructions')) {
                return;
            }

            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(0.95);
                background: white;
                padding: 25px;
                border-radius: 16px;
                box-shadow: 0 10px 25px rgba(0,0,0,0.1);
                z-index: 1000;
                max-width: 90%;
                width: 400px;
                opacity: 0;
                transition: all 0.3s ease;
            `;

            popup.innerHTML = `
                <div style="
                    text-align: center;
                    margin-bottom: 20px;
                ">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-bottom: 15px;">
                        <path d="M15 3H21V9" stroke="#4f46e5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9 21H3V15" stroke="#4f46e5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M21 3L14 10" stroke="#4f46e5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M3 21L10 14" stroke="#4f46e5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <h3 style="
                        margin: 0 0 15px 0;
                        color: #1f2937;
                        font-size: 25px;
                        font-weight: 600;
                    ">Hướng dẫn phóng to/thu nhỏ</h3>
                </div>
                <div style="
                    background: #f3f4f6;
                    padding: 15px;
                    border-radius: 8px;
                    margin-bottom: 20px;
                ">
                    <p style="
                        margin: 0;
                        color: #4b5563;
                        font-size: 20px;
                        line-height: 1.6;
                    ">
                        Bạn có thể sử dụng tổ hợp phím sau để phóng to/thu nhỏ nội dung cho phù hợp với màn hình của bạn:
                    </p>
                    <div style="
                        margin-top: 12px;
                        display: flex;
                        flex-direction: column;
                        gap: 8px;
                    ">
                        <div style="
                            display: flex;
                            align-items: center;
                            gap: 8px;
                        ">
                            <span style="
                                background: #e5e7eb;
                                padding: 4px 8px;
                                border-radius: 4px;
                                font-size: 20px;
                                color: #374151;
                            ">Windows</span>
                            <span style="color: #4b5563;">Ctrl + (+/-)</span>
                        </div>
                        <div style="
                            display: flex;
                            align-items: center;
                            gap: 8px;
                        ">
                            <span style="
                                background: #e5e7eb;
                                padding: 4px 8px;
                                border-radius: 4px;
                                font-size: 20px;
                                color: #374151;
                            ">Mac</span>
                            <span style="color: #4b5563;">Command + (+/-)</span>
                        </div>
                    </div>
                </div>
                <button id="dismissPopup" style="
                    background: #4f46e5;
                    color: white;
                    padding: 10px 20px;
                    border-radius: 8px;
                    border: none;
                    cursor: pointer;
                    width: 100%;
                    font-size: 15px;
                    font-weight: 500;
                    transition: background-color 0.2s ease;
                ">Không hiển thị lại</button>
            `;

            document.body.appendChild(popup);

            // Trigger animation
            requestAnimationFrame(() => {
                popup.style.transform = 'translate(-50%, -50%) scale(1)';
                popup.style.opacity = '1';
            });

            // Add hover effect to button
            const button = document.getElementById('dismissPopup');
            button.addEventListener('mouseover', () => {
                button.style.backgroundColor = '#4338ca';
            });
            button.addEventListener('mouseout', () => {
                button.style.backgroundColor = '#4f46e5';
            });

            button.addEventListener('click', () => {
                popup.style.transform = 'translate(-50%, -50%) scale(0.95)';
                popup.style.opacity = '0';
                setTimeout(() => {
                    localStorage.setItem('hideZoomInstructions', 'true');
                    popup.remove();
                }, 300);
            });
        }

        // Run on page load
        window.addEventListener('DOMContentLoaded', () => {
            adjustFontSize();
            showZoomInstructions();
        });

        // Run when window is resized
        window.addEventListener('resize', adjustFontSize);
    </script>

    <style>
        body {
            font-family: 'Baloo 2', cursive;
            transition: background-color 0.5s ease;
        }

        .slide {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .slide.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes float {
            0% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
            100% {
                transform: translateY(0px);
            }
        }

        .floating {
            animation: float 3s ease-in-out infinite;
        }

        .content-box {
            background-color: rgba(255, 255, 255, 0.45);
            overflow-y: auto;
            padding: 1rem 1rem 2rem 1rem;
        }

        .exercise-input {
            border-bottom: 2px dashed #4f46e5;
            min-width: 100px;
            display: inline-block;
            text-align: center;
        }

        .exercise-input:focus {
            outline: none;
            border-bottom: 2px solid #4f46e5;
        }

        .btn-check {
            background-color: #4f46e5;
            color: white;
        }

        .btn-check:hover {
            background-color: #4338ca;
        }

        .correct {
            color: #10b981;
            font-weight: bold;
        }

        .incorrect {
            color: #ef4444;
            font-weight: bold;
        }

        .highlight {
            background-color: #fef08a;
            padding: 2px 4px;
            border-radius: 4px;
        }

        .thought-bubble {
            position: absolute;
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .thought-bubble:after {
            content: '';
            position: absolute;
            border-style: solid;
            border-width: 15px 0 15px 25px;
            border-color: transparent white;
            display: block;
            width: 0;
            z-index: 1;
        }

        .boy {
            animation: bounce 2s ease infinite;
        }

        @keyframes bounce {
            0%,
            100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .verb-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .verb-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .verb-example {
            border-left: 4px solid #4f46e5;
            padding-left: 12px;
        }

        .outline-content {
            background: white;
            border-radius: 16px;
            padding: 20px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 20px;
        }

        .outline-item {
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
            padding: 10px;
        }

        .outline-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .outline-slide {
            display: block;
            transform: scale(0.3);
            transform-origin: top left;
            width: 333.33%; /* 100% / 0.3 */
            height: 333.33%; /* 100% / 0.3 */
            pointer-events: none;
            background-color: white;
        }

        .slide-preview {
            width: 300px;
            height: 250px;
            overflow: hidden;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            margin: 0 auto;
        }
        
        .slide-wrapper {
            width: 1200px;
            height: 1000px;
            transform: scale(0.25);
            transform-origin: top left;
        }

        .slide-wrapper > .slide {
            display: block !important;
            pointer-events: none;
        }

        .modal-verb {
            background: white;
            border-radius: 12px;
            padding: 20px;
            max-width: 500px;
            animation: popIn 0.3s ease-out;
        }

        @keyframes popIn {
            0% {
                transform: scale(0.5);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
    </style>
</head>

<body class="bg-blue-50 bg-[url('https://cdn.photoroom.com/v2/image-cache?path=gs://background-7ef44.appspot.com/backgrounds_v3/nice/31_nice.jpg')] bg-cover bg-center min-h-screen flex items-center justify-center p-2">

    <div class="relative w-full max-w-6xl h-[95vh] mx-auto">
        <!-- Slide counter -->
        <div class="absolute bottom-2 sm:bottom-full sm:top-7 right-4 z-50 flex items-center gap-2">
            <button onclick="showSlide(currentSlide - 1)"
                class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-lg font-bold text-indigo-600 hover:bg-indigo-50">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
            </button>
            <button onclick="showSlide(currentSlide + 1)"
                class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-lg font-bold text-indigo-600 hover:bg-indigo-50">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
            </button>
            <button onclick="toggleOutline()"
                class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-lg font-bold text-indigo-600 hover:bg-indigo-50">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
            <div
                class="bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-lg font-bold text-indigo-600 text-xs">
                <span id="slide-counter"></span>
            </div>
        </div>

        <!-- Outline Modal -->
        <div id="outlineModal"
            class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
            <div id="outlineContent" class="outline-content">
                <!-- Outline content will be dynamically generated here -->
            </div>
        </div>

        <!-- Slides container -->
        <div class="relative w-full h-full overflow-hidden rounded-2xl shadow-2xl">
            <!-- Slide 1: Title -->
            <div class="slide active content-box px-5 py-2 rounded-2xl w-full h-full">
                <div class="flex flex-col items-center justify-start h-full text-center">
                    <h1 class="text-2xl font-bold text-indigo-700 mb-8">GRAMMAR FOR PRE-GRADE 6</h1>
                    <div
                        class="bg-yellow-400 text-2xl md:text-4xl font-bold px-6 py-3 rounded-full mb-5 shadow-lg floating">
                        Chủ ngữ giả: It, There
                    </div>
                    <div class="flex flex-col md:flex-row items-center justify-center gap-8">
                        <div class="mt-6 flex justify-center">
                            <img src="https://img.freepik.com/free-photo/notebook-with-grammar-word-school-suplies_23-2149436698.jpg"
                                alt="Grammar Learning" class="object-cover h-52 rounded-xl floating">
                        </div>
                        <div
                            class="bg-gradient-to-r from-indigo-100 to-green-200 border-l-4 border-indigo-500 py-5 px-10 text-left rounded-2xl text-2xl">
                            <p class="font-bold text-indigo-800">Mục tiêu bài học:</p>
                            <ul class="list-disc pl-5 text-gray-700 text-2xl">
                                <li>Hiểu và sử dụng chủ ngữ giả 'It'</li>
                                <li>Nắm vững cấu trúc 'It's...'</li>
                                <li>Hiểu và sử dụng chủ ngữ giả 'There'</li>
                                <li>Thành thạo cấu trúc 'There is / There are'</li>
                            </ul>
                        </div>
                    </div>
                    <div class="my-3 opacity-0">---</div>
                </div>
            </div>

            <!-- Slide 2: Giới thiệu chủ ngữ giả It -->
            <div class="slide content-box px-5 py-2 rounded-2xl w-full h-full">
                <h2 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-5">1. Chủ ngữ giả 'It'</h2>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <p class="text-2xl mb-4">Chủ ngữ giả 'It' được dùng khi chủ ngữ thật của câu là một mệnh đề hoặc một cụm từ dài, hoặc khi nói về thời tiết, thời gian, khoảng cách.</p>
                    <div class="mt-4 space-y-4">
                        <div class="verb-example">
                            <p class="text-2xl"><span class="font-bold text-blue-500">It</span> is important to learn English.</p>
                            <p class="text-gray-600">(Học tiếng Anh rất quan trọng.)</p>
                        </div>
                        <div class="verb-example">
                            <p class="text-2xl"><span class="font-bold text-blue-500">It</span> is raining.</p>
                            <p class="text-gray-600">(Trời đang mưa.)</p>
                        </div>
                        <div class="verb-example">
                            <p class="text-2xl"><span class="font-bold text-blue-500">It</span> is 5 o'clock.</p>
                            <p class="text-gray-600">(Bây giờ là 5 giờ.)</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 3: Cấu trúc It's... -->
            <div class="slide content-box px-5 py-2 rounded-2xl w-full h-full text-2xl">
                <h2 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-5">2. Cấu trúc 'It's...'</h2>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <p class="text-2xl mb-4">Cấu trúc 'It's...' (viết tắt của 'It is...') thường được dùng để nói về:</p>
                    <ul class="list-disc pl-5 text-gray-700 space-y-2">
                        <li><span class="font-bold">Thời tiết:</span> It's sunny. (Trời nắng.)</li>
                        <li><span class="font-bold">Thời gian:</span> It's ten past nine. (Bây giờ là 9 giờ 10 phút.)</li>
                        <li><span class="font-bold">Khoảng cách:</span> It's far from here to the school. (Từ đây đến trường xa.)</li>
                        <li><span class="font-bold">Đánh giá:</span> It's easy to understand. (Nó dễ hiểu.)</li>
                    </ul>
                </div>
            </div>

            <!-- Slide 4: Giới thiệu chủ ngữ giả There -->
            <div class="slide content-box px-5 py-2 rounded-2xl w-full h-full text-2xl">
                <h2 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-5">3. Chủ ngữ giả 'There'</h2>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <p class="text-2xl mb-4">Chủ ngữ giả 'There' được dùng để nói về sự tồn tại của một người hoặc vật ở một nơi nào đó.</p>
                    <div class="mt-4 space-y-4">
                        <div class="verb-example">
                            <p class="text-2xl"><span class="font-bold text-purple-500">There is</span> a book on the table.</p>
                            <p class="text-gray-600">(Có một quyển sách trên bàn.)</p>
                        </div>
                        <div class="verb-example">
                            <p class="text-2xl"><span class="font-bold text-purple-500">There are</span> two cats in the garden.</p>
                            <p class="text-gray-600">(Có hai con mèo trong vườn.)</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 5: Cấu trúc There is / There are -->
            <div class="slide content-box px-5 py-2 rounded-2xl w-full h-full">
                <h2 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-5">4. Cấu trúc 'There is / There are'</h2>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <p class="text-2xl mb-4">Chúng ta sử dụng 'There is' với danh từ số ít và danh từ không đếm được. Chúng ta sử dụng 'There are' với danh từ số nhiều.</p>
                    <table class="w-full mt-3 text-center bg-white rounded-lg overflow-hidden text-2xl">
                        <thead class="bg-indigo-200">
                            <tr>
                                <th class="p-2">Số ít / Không đếm được</th>
                                <th class="p-2">Số nhiều</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b">
                                <td class="p-2"><span class="font-bold text-red-500">There is</span> a pen.</td>
                                <td class="p-2"><span class="font-bold text-red-500">There are</span> many pens.</td>
                            </tr>
                            <tr>
                                <td class="p-2"><span class="font-bold text-red-500">There is</span> some water.</td>
                                <td class="p-2"></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="mt-4 space-y-2">
                        <p class="text-2xl">Câu hỏi: <span class="highlight">Is there</span> a book? / <span class="highlight">Are there</span> any books?</p>
                        <p class="text-2xl">Phủ định: <span class="highlight">There isn't</span> a book. / <span class="highlight">There aren't</span> any books.</p>
                    </div>
                </div>
            </div>

            <!-- Slide 6: Phân biệt There is/are và Have/has -->
            <div class="slide content-box px-5 py-2 rounded-2xl w-full h-full">
                <h2 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-5">5. Phân biệt There is/are và Have/has</h2>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <p class="text-2xl mb-4">Học sinh thường nhầm lẫn giữa 'There is/are' và 'have/has'. Hãy cùng xem sự khác biệt:</p>
                    <table class="w-full mt-3 text-center bg-white rounded-lg overflow-hidden text-2xl">
                        <thead class="bg-indigo-200">
                            <tr>
                                <th class="p-2">There is / There are</th>
                                <th class="p-2">Have / Has</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b">
                                <td class="p-2">Dùng để nói về <span class="font-bold text-green-500">sự tồn tại</span> của một vật/người ở một nơi nào đó.</td>
                                <td class="p-2">Dùng để nói về <span class="font-bold text-red-500">sự sở hữu</span> (ai đó có cái gì đó).</td>
                            </tr>
                            <tr class="border-b">
                                <td class="p-2">Ví dụ: <span class="highlight">There is</span> a book on the table. (Có một quyển sách trên bàn.)</td>
                                <td class="p-2">Ví dụ: I <span class="highlight">have</span> a book. (Tôi có một quyển sách.)</td>
                            </tr>
                            <tr>
                                <td class="p-2">Ví dụ: <span class="highlight">There are</span> three chairs in the room. (Có ba cái ghế trong phòng.)</td>
                                <td class="p-2">Ví dụ: She <span class="highlight">has</span> three chairs. (Cô ấy có ba cái ghế.)</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="mt-4 bg-yellow-100 p-4 rounded-lg">
                        <p class="font-bold text-yellow-800 text-2xl">💡 Nhớ rằng: 'There is/are' trả lời câu hỏi "Có cái gì đó không?", còn 'have/has' trả lời câu hỏi "Ai đó có cái gì?".</p>
                    </div>
                </div>
            </div>

            <!-- Slide 7: Bài tập It's... / There is/are -->
            <div class="slide content-box px-5 py-2 rounded-2xl w-full h-full">
                <h2 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-5">4. Cấu trúc 'There is / There are'</h2>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <p class="text-2xl mb-4">Chúng ta sử dụng 'There is' với danh từ số ít và danh từ không đếm được. Chúng ta sử dụng 'There are' với danh từ số nhiều.</p>
                    <table class="w-full mt-3 text-center bg-white rounded-lg overflow-hidden text-2xl">
                        <thead class="bg-indigo-200">
                            <tr>
                                <th class="p-2">Số ít / Không đếm được</th>
                                <th class="p-2">Số nhiều</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b">
                                <td class="p-2"><span class="font-bold text-red-500">There is</span> a pen.</td>
                                <td class="p-2"><span class="font-bold text-red-500">There are</span> many pens.</td>
                            </tr>
                            <tr>
                                <td class="p-2"><span class="font-bold text-red-500">There is</span> some water.</td>
                                <td class="p-2"></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="mt-4 space-y-2">
                        <p class="text-2xl">Câu hỏi: <span class="highlight">Is there</span> a book? / <span class="highlight">Are there</span> any books?</p>
                        <p class="text-2xl">Phủ định: <span class="highlight">There isn't</span> a book. / <span class="highlight">There aren't</span> any books.</p>
                    </div>
                </div>
            </div>

            <!-- Slide 6: Bài tập It's... / There is/are -->
            <div class="slide content-box px-5 py-2 rounded-2xl w-full h-full">
                <h2 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-5">Bài tập 1: It's hay There is/are?</h2>
                <p class="text-2xl mb-8">Điền 'It's' hoặc 'There is/are' vào chỗ trống:</p>
                <div class="grid grid-cols-1 gap-4">
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4"><input type="text" class="exercise-input" data-answer="It's"> sunny today.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4"><input type="text" class="exercise-input" data-answer="There is"> a cat on the roof.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4"><input type="text" class="exercise-input" data-answer="It's"> 7 o'clock.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4"><input type="text" class="exercise-input" data-answer="There are"> many students in the class.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4"><input type="text" class="exercise-input" data-answer="It's"> difficult to learn Chinese.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4"><input type="text" class="exercise-input" data-answer="There is"> some milk in the fridge.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4"><input type="text" class="exercise-input" data-answer="It's"> cold outside.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4"><input type="text" class="exercise-input" data-answer="There are"> five apples in the basket.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4"><input type="text" class="exercise-input" data-answer="It's"> a long way to the beach.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4"><input type="text" class="exercise-input" data-answer="There is"> a new movie on TV tonight.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                </div>
            </div>

            <!-- Slide 7: Bài tập chuyển đổi câu -->
            <div class="slide content-box px-5 py-2 rounded-2xl w-full h-full">
                <h2 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-5">Bài tập 2: Chuyển đổi câu</h2>
                <p class="text-2xl mb-8">Chuyển các câu sau sang dạng phủ định hoặc nghi vấn:</p>
                <div class="grid grid-cols-1 gap-4">
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4">It is hot today. (Phủ định) → <input type="text" class="exercise-input" data-answer="It isn't hot today">.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4">There are two books on the desk. (Nghi vấn) → <input type="text" class="exercise-input" data-answer="Are there two books on the desk">?</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4">It is easy to learn English. (Phủ định) → <input type="text" class="exercise-input" data-answer="It isn't easy to learn English">.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4">There is a dog in the house. (Nghi vấn) → <input type="text" class="exercise-input" data-answer="Is there a dog in the house">?</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4">It is 9 PM. (Phủ định) → <input type="text" class="exercise-input" data-answer="It isn't 9 PM">.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4">There are many cars on the street. (Nghi vấn) → <input type="text" class="exercise-input" data-answer="Are there many cars on the street">?</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4">It is far from here to the hospital. (Phủ định) → <input type="text" class="exercise-input" data-answer="It isn't far from here to the hospital">.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4">There is a problem. (Nghi vấn) → <input type="text" class="exercise-input" data-answer="Is there a problem">?</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4">It is necessary to study hard. (Phủ định) → <input type="text" class="exercise-input" data-answer="It isn't necessary to study hard">.</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                    <div class="exercise-item bg-white p-4 rounded-xl shadow-md">
                        <p class="text-2xl mb-4">There are some birds in the tree. (Nghi vấn) → <input type="text" class="exercise-input" data-answer="Are there any birds in the tree">?</p>
                        <div class="flex items-center space-x-4"><button onclick="checkInput(this)" class="btn-check px-4 py-2 rounded-lg font-bold">Kiểm tra</button><div class="answer hidden text-2xl"></div></div>
                    </div>
                </div>
            </div>

            <!-- Slide 8: Tổng kết -->
            <div class="slide content-box px-5 py-2 rounded-2xl w-full h-full">
                <div class="flex flex-col items-center justify-start h-full">
                    <h2 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-5">Tổng kết bài học</h2>
                    <div class="w-full bg-white p-6 rounded-xl shadow-md">
                        <div class="bg-blue-50 p-4 rounded-lg mb-6">
                            <p class="text-2xl font-bold text-blue-800 text-center">Kiến thức trọng tâm</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg mb-4">
                            <p class="text-2xl font-bold text-green-800">1. Chủ ngữ giả 'It'</p>
                            <ul class="list-disc pl-6 mt-2 space-y-2">
                                <li>Dùng để nói về thời tiết, thời gian, khoảng cách, hoặc khi chủ ngữ thật dài.</li>
                                <li>Cấu trúc: It's + tính từ/danh từ/cụm từ.</li>
                            </ul>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <p class="text-2xl font-bold text-purple-800">2. Chủ ngữ giả 'There'</p>
                            <ul class="list-disc pl-6 mt-2 space-y-2">
                                <li>Dùng để nói về sự tồn tại của người/vật.</li>
                                <li>Cấu trúc: There is (số ít/không đếm được) / There are (số nhiều).</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 9: Kết thúc -->
            <div class="slide content-box px-5 py-2 rounded-2xl w-full h-full">
                <div class="flex flex-col items-center justify-start h-full text-center">
                    <h1 class="text-2xl font-bold text-indigo-700 mb-3">Chúc mừng!</h1>
                    <div class="text-2xl md:text-3xl text-gray-700 mb-3">
                        <p class="mb-4">Bạn đã hoàn thành bài học về</p>
                        <div
                            class="bg-gradient-to-r from-yellow-400 to-red-500 text-white text-4xl font-bold px-6 py-2 rounded-full inline-block">
                            CHỦ NGỮ GIẢ: IT, THERE
                        </div>
                    </div>
                    <div class="flex justify-center mb-3">
                        <img src="https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-1.2.1&auto=format&fit=crop&w=634&q=80"
                            class="h-32 rounded-xl object-cover" alt="Celebration Image">
                    </div>
                    <div class="bg-gradient-to-r from-green-400 to-blue-500 text-white p-6 rounded-xl max-w-xl">
                        <p class="text-2xl md:text-2xl font-bold mb-2">Hẹn gặp lại trong bài học tiếp theo!</p>
                    </div>
                </div>
            </div> 
        </div>
    </div>

    <script>
        // Outline Modal functions
        function toggleOutline() {
            const modal = document.getElementById('outlineModal');
            const isHidden = modal.classList.contains('hidden');
            
            if (isHidden) {
                // Generate outline content when opening
                generateOutline();
            }
            
            modal.classList.toggle('hidden');
        }

        function generateOutline() {
            const outlineContent = document.getElementById('outlineContent');
            outlineContent.innerHTML = '';
            const slides = document.querySelectorAll('.slide');
            let outlineHTML = '';

            slides.forEach((slide, index) => {
                const isActive = index === currentSlide;
                const slideClone = slide.cloneNode(true);
                
                slideClone.classList.remove('active');
                
                outlineHTML += `
                    <div class="outline-item rounded-lg cursor-pointer relative ${isActive ? 'ring-2 ring-indigo-500 bg-indigo-50' : 'bg-white shadow-md'}" 
                          onclick="goToSlide(${index})">
                        <div class="slide-number text-xs bg-indigo-100 text-indigo-600 px-2 py-1 rounded-full font-medium mb-2 inline-block absolute bottom-1 right-5 z-10">
                            Slide ${index + 1}
                        </div>
                        <div class="slide-preview">
                            <div class="slide-wrapper">
                                ${slideClone.outerHTML}
                            </div>
                        </div>
                    </div>
                `;
            });

            outlineContent.innerHTML = outlineHTML;
        }

        function goToSlide(slideNumber) {
            showSlide(slideNumber);
            toggleOutline(); // Đóng modal sau khi chuyển slide
        }

        // Close modal when clicking outside
        document.getElementById('outlineModal').addEventListener('click', function (e) {
            if (e.target === this) {
                toggleOutline();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape' && !document.getElementById('outlineModal').classList.contains('hidden')) {
                toggleOutline();
            }
        });

        // Slide management
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length; // This will now be 10
        const slideCounter = document.getElementById('slide-counter');

        // Update URL with current slide
        function updateURL(slideNumber) {
            const url = new URL(window.location.href);
            url.searchParams.set('slide', slideNumber + 1);
            window.history.pushState({}, '', url);
        }

        // Get initial slide from URL if present
        function getInitialSlide() {
            const url = new URL(window.location.href);
            const slideParam = url.searchParams.get('slide');
            if (slideParam) {
                const slideNumber = parseInt(slideParam) - 1;
                if (slideNumber >= 0 && slideNumber < totalSlides) {
                    return slideNumber;
                }
            }
            return 0;
        }

        // Update the counter display with total slides
        function updateSlideCounter() {
            slideCounter.textContent = `${currentSlide + 1}/${totalSlides}`;
        }

        function showSlide(n) {
            // Hide all slides
            slides.forEach(slide => {
                slide.classList.remove('active');
            });

            // Calculate new slide index
            currentSlide = (n + totalSlides) % totalSlides;

            // Show new slide
            slides[currentSlide].classList.add('active');

            // Update slide counter
            updateSlideCounter();

            // Update URL
            updateURL(currentSlide);

            // Update outline if it's open
            if (!document.getElementById('outlineModal').classList.contains('hidden')) {
                generateOutline();
            }
        }

        // Initialize with slide from URL if present
        currentSlide = getInitialSlide();
        showSlide(currentSlide);

        // Touch swipe detection
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        }, { passive: true });

        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, { passive: true });

        function handleSwipe() {
            const threshold = 50;
            const diff = touchStartX - touchEndX;
            if (diff > threshold) {
                showSlide(currentSlide + 1);
            } else if (diff < -threshold) {
                showSlide(currentSlide - 1);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', function (e) {
            if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
                showSlide(currentSlide + 1);
            } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
                showSlide(currentSlide - 1);
            }
        });

        // Exercise functions
        function showAnswer(button) {
            const answerDiv = button.nextElementSibling;
            answerDiv.classList.toggle('hidden');
            button.textContent = answerDiv.classList.contains('hidden') ? 'Xem đáp án' : 'Ẩn đáp án';
        }

        function checkInput(button) {
            const exerciseItem = button.closest('.exercise-item');
            const inputs = exerciseItem.querySelectorAll('.exercise-input');
            const answerDiv = exerciseItem.querySelector('.answer');
            let allCorrect = true;
            let answersHtml = '<div class="space-y-2">';

            inputs.forEach(input => {
                const userAnswer = input.value.trim().toLowerCase().replace(/[.?]/g, '');
                const correctAnswer = input.dataset.answer.toLowerCase().replace(/[.?]/g, '');

                if (userAnswer === correctAnswer) {
                    answersHtml += `<p class="correct">✓ Đúng: ${input.dataset.answer}</p>`;
                    input.style.borderBottom = '2px solid #10b981';
                } else {
                    answersHtml += `<p class="incorrect">✗ Sai: Đáp án đúng là "${input.dataset.answer}" (Bạn điền: "${input.value.trim() || 'trống'}")</p>`;
                    input.style.borderBottom = '2px solid #ef4444';
                    allCorrect = false;
                }
            });

            answersHtml += '</div>';
            answerDiv.innerHTML = answersHtml;
            answerDiv.classList.remove('hidden');

            // Change button to reset button
            button.textContent = 'Làm lại';
            button.onclick = function () {
                resetExercise(button);
            };

            if (allCorrect) {
                exerciseItem.classList.add('bg-green-50');
            }
        }

        function checkSelect(button) {
            const exerciseItem = button.closest('.exercise-item');
            const select = exerciseItem.querySelector('select');
            const answerDiv = exerciseItem.querySelector('.answer');
            const correctAnswer = select.dataset.answer;

            if (select.value === correctAnswer) {
                answerDiv.innerHTML = '<p class="correct">✓ Chính xác!</p>';
                select.classList.add('border-green-500');
                select.classList.remove('border-indigo-300');
            } else {
                answerDiv.innerHTML = `<p class="incorrect">✗ Sai rồi! Đáp án đúng là: <span class="font-bold">${correctAnswer}</span></p>`;
                select.classList.add('border-red-500');
                select.classList.remove('border-indigo-300');
            }

            answerDiv.classList.remove('hidden');

            // Change button to reset button
            button.textContent = 'Làm lại';
            button.onclick = function () {
                resetExercise(button);
            };
        }

        function checkMCQ(button, correctAnswer) {
            const exerciseItem = button.closest('.exercise-item');
            const answerDiv = exerciseItem.querySelector('.answer');
            const allButtons = exerciseItem.querySelectorAll('button:not(.btn-check)');
            
            let userAnswer = button.textContent.trim();
            if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
                answerDiv.innerHTML = '<p class="correct">✓ Chính xác!</p>';
                button.classList.remove('bg-gray-200');
                button.classList.add('bg-green-500', 'text-white');
            } else {
                answerDiv.innerHTML = `<p class="incorrect">✗ Sai rồi! Đáp án đúng là: <span class="font-bold">${correctAnswer}</span></p>`;
                button.classList.remove('bg-gray-200');
                button.classList.add('bg-red-500', 'text-white');
                
                // Highlight the correct answer
                allButtons.forEach(btn => {
                    if (btn.textContent.trim().toLowerCase() === correctAnswer.toLowerCase()) {
                        btn.classList.remove('bg-gray-200');
                        btn.classList.add('bg-green-500', 'text-white');
                    }
                });
            }

            answerDiv.classList.remove('hidden');

            // Disable all buttons after answering
            allButtons.forEach(btn => {
                btn.disabled = true;
            });

            // Add reset button
            const resetBtnContainer = answerDiv.parentNode;
            let resetBtn = resetBtnContainer.querySelector('.reset-btn');
            if (!resetBtn) {
                resetBtn = document.createElement('button');
                resetBtn.textContent = 'Làm lại';
                resetBtn.className = 'btn-check px-4 py-2 rounded-lg font-bold mt-2 reset-btn';
                resetBtn.onclick = function() {
                    resetMCQ(exerciseItem);
                };
                answerDiv.appendChild(resetBtn);
            }
        }
        
        function resetMCQ(exerciseItem) {
            const answerDiv = exerciseItem.querySelector('.answer');
            const allButtons = exerciseItem.querySelectorAll('button:not(.btn-check)');

            allButtons.forEach(btn => {
                btn.disabled = false;
                btn.classList.remove('bg-green-500', 'bg-red-500', 'text-white');
                btn.classList.add('bg-gray-200');
            });
            
            answerDiv.innerHTML = '';
            answerDiv.classList.add('hidden');
        }


        function resetExercise(button) {
            const exerciseItem = button.closest('.exercise-item');
            const inputs = exerciseItem.querySelectorAll('.exercise-input');
            const selects = exerciseItem.querySelectorAll('select');
            const answerDiv = exerciseItem.querySelector('.answer');
            
            // Reset inputs
            inputs.forEach(input => {
                input.value = '';
                input.style.borderBottom = '2px dashed #4f46e5';
            });

            // Reset selects
            selects.forEach(select => {
                select.value = '';
                select.classList.remove('border-green-500', 'border-red-500');
                select.classList.add('border-indigo-300');
            });

            // Reset answer display
            answerDiv.innerHTML = '';
            answerDiv.classList.add('hidden');

            // Reset button
            button.textContent = 'Kiểm tra';
            button.onclick = function () {
                if (inputs.length > 0) checkInput(button);
                if (selects.length > 0) checkSelect(button);
            };

            // Remove success background
            exerciseItem.classList.remove('bg-green-50');
        }
    </script>
</body>

</html>